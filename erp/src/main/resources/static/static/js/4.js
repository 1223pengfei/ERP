webpackJsonp([4,7],{"9z6i":function(e,t){},FZpI:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("sejs"),r={props:{deplist:Array,withoutModule:String},data:function(){return{without:"暂无数据",permissionVisible:!1,jobVisible:!1,ruleList:[],checkList:[],premissionList:[],depname:"",getIndex:"",ruleid:"",radio:"",depid:"",jobsid:"",jobid:"",defaultdata:{value:"departmentid",label:"depname",children:"departments"},defaultpremission:{value:"permissionid",label:"permissionname",children:"permissions"},arrJobid:[],permissionList:[],permissionItem:[],arrpermission:[],arrJobs:[],ruleidList:[],multipleSelection:[],rules:[],rulesid:[],result:[],hash:[],permissionsidList:[]}},mounted:function(){this.allAuths(),this.allrules(),this.allLink()},methods:{setNullpre:function(){this.$refs.tree.setCheckedKeys([])},setNulljob:function(){this.$refs.ruleTable.clearSelection()},tableclick:function(e){var t=this;this.$refs.ruleTable.clearSelection(),this.$refs.jobTable.setCurrentRow(),this.ruleid=e.ruleid,this.arrpermission=[],this.$refs.tree.setCheckedKeys([]),this.permissionarr=e.permissions,this.permissionarr.forEach(function(e){t.arrpermission.push(e.permissionid)})},subimitlinkjob:function(){var e=this,t=this.rulesid.join("_");if(""!=t&&""!=this.jobid){var s=new URLSearchParams;s.append("jobid",this.jobid),s.append("ruleid",t),this.$http.post("/link/jr.do",s).then(function(t){"permission.html"===t.data?e.$message.error("您没有权限！请联系管理员！"):(e.$message.success("分配成功"),e.jobAndrul=t.data)})}else this.$message.error("请选中职务和角色！")},handleCurrentJobs:function(e){var t=this;this.rules=[],this.permissionsidList=[],this.$refs.ruleTable.setCurrentRow(),this.$refs.ruleTable.clearSelection(),this.jobid=e.jobid,this.jobAndrul.forEach(function(e){t.jobid===e.jobid&&(t.rules=e.rules,console.log(t.rules))}),this.rules.forEach(function(e,s){e.permissions.forEach(function(e){t.permissionsidList.push(e.permissionid)})}),void 0!==this.ruleList&&void 0!==this.multipleSelection&&this.rules.forEach(function(e,s){t.ruleList.forEach(function(s,i){e.ruleid===s.ruleid&&t.$refs.ruleTable.toggleRowSelection(s)})}),this.unique4(this.permissionsidList)},unique4:function(e){if(this.arrpermission=[],0!=e.length)for(var t=0;t<e.length;t++)this.arrpermission.includes(e[t])||this.arrpermission.push(e[t]);else this.$refs.tree.setCheckedKeys([])},setCurrentRul:function(e){this.removeRuleTable=e,this.$refs.ruleTable.setCurrentRow(e),this.$refs.tree.setCheckedKeys([])},setCurrentJob:function(e){this.removeJobTablee=e,this.$refs.ruleTable.clearSelection(),this.$refs.jobTable.setCurrentRow(e),this.$refs.tree.setCheckedKeys([])},handlepermissionTree:function(){var e=this;this.permissionItem=this.$refs.tree.getCheckedNodes(),this.permissionList=[],this.permissionItem.forEach(function(t){e.permissionList.push(t.permissionid)})},handleNodeClick:function(e){this.$refs.ruleTable.clearSelection(),this.$refs.tree.setCheckedKeys([]),this.depname=e.depname,this.depid=e.departmentid,this.arrJobs=e.jobs},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,this.rulesid=[],this.multipleSelection.forEach(function(e){t.rulesid.push(e.ruleid)})},permissionRow:function(){var e=this,t=this.permissionList.join("_");if(""!=this.ruleid&&""!=t){var s=new URLSearchParams;s.append("ruleid",this.ruleid),s.append("perid",t),this.$http.post("/link/rp.do",s).then(function(t){"permission.html"===t.data?e.$message.error("您没有权限！请联系管理员！"):"ok"==t.data.msg?(e.$message.success("分配成功"),e.ruleList=t.data.rules,e.allLink(),e.permissionVisible=!1):e.$message.error("分配失败，请重试！")})}else this.$message.error("请选中角色或权限！")},allAuths:function(){var e=this;this.$http.post("getAuths.do").then(function(t){"permission.html"===t.data?e.without="无权限，请联系管理员":e.premissionList=t.data.premission})},allrules:function(){var e=this;this.$http.post("link/getRules.do").then(function(t){"permission.html"===t.data?e.without="无权限，请联系管理员":e.ruleList=t.data})},allLink:function(){var e=this;this.$http.post("link/jobs.do").then(function(t){"permission.html"===t.data?e.without="无权限，请联系管理员":e.jobAndrul=t.data})}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table_box"},[s("el-row",{attrs:{gutter:18}},[s("el-col",{attrs:{span:4}},[s("el-tree",{ref:"tree",staticClass:"tree",attrs:{data:e.deplist,props:e.defaultdata,"node-key":"departmentid","default-expand-all":"","expand-on-click-node":!1,"empty-text":e.withoutModule},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return s("span",{staticClass:"custom-tree-node"},[s("span",[e._v(e._s(i.label))])])}}])})],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"pretree"},[s("h3",[e._v(e._s(e.depname)+"职务表111")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.subimitlinkjob}},[e._v("关联角色")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(t){e.setCurrentJob()}}},[e._v("取消选择")])],1),e._v(" "),s("el-table",{ref:"jobTable",attrs:{data:e.arrJobs,border:"","highlight-current-row":"","header-cell-class-name":"table-header","empty-text":e.without},on:{"row-click":e.handleCurrentJobs}},[s("el-table-column",{attrs:{label:"序号",type:"index",width:"65"}}),e._v(" "),s("el-table-column",{attrs:{prop:"jobname",label:"职位"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"pretree"},[s("h3",[e._v("全部角色")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.permissionRow}},[e._v("关联权限")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(t){e.setCurrentRul()}}},[e._v("取消选择")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.setNulljob}},[e._v("重置")])],1),e._v(" "),s("el-table",{ref:"ruleTable",attrs:{data:e.ruleList,border:"","highlight-current-row":"","header-cell-class-name":"table-header","empty-text":e.without},on:{"row-click":e.tableclick,"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),s("el-table-column",{attrs:{prop:"rulename",label:"角色名"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.rulename))])]}}])})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"pretree"},[s("h3",[e._v("全部权限")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.setNullpre}},[e._v("重置")])],1),e._v(" "),s("el-tree",{ref:"tree",staticClass:"tree",attrs:{data:e.premissionList,props:e.defaultpremission,"show-checkbox":"","default-expanded-keys":e.arrpermission,"default-checked-keys":e.arrpermission,"node-key":"permissionid","default-expand-all":"","expand-on-click-node":!1,"empty-text":e.without},on:{"check-change":function(t){e.handlepermissionTree()}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return s("span",{staticClass:"custom-tree-node"},[s("span",[e._v(e._s(i.label))])])}}])})],1)],1)],1)},staticRenderFns:[]};var l=s("VU/8")(r,n,!1,function(e){s("9z6i")},null,null).exports,a={data:function(){return{withoutModule:"暂无数据",deplist:[],tabPosition:"left",activeName:"first"}},mounted:function(){this.allDeplist()},methods:{handleClick:function(e,t){"second"==this.activeName&&this.allDeplist()},allDeplist:function(){var e=this;this.$http.post("/department/list.do").then(function(t){"permission.html"===t.data?e.withoutModule="无权限，请联系管理员":e.deplist=t.data})}},components:{vJobtitle:i.default,vAuthority:l}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"trace"},[s("div",{staticClass:"btn_box"}),e._v(" "),s("el-tabs",{attrs:{"tab-position":e.tabPosition},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[s("v-jobtitle")],1),e._v(" "),s("el-tab-pane",{attrs:{label:"角色管理",name:"second"}},[s("v-authority",{attrs:{deplist:e.deplist,withoutModule:e.withoutModule}})],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(a,o,!1,function(e){s("lnkn")},"data-v-6118c120",null);t.default=u.exports},bw9u:function(e,t){},lnkn:function(e,t){},sejs:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("cvWx"),r=s("nIuf"),n={name:"jobtitleLink",data:function(){return{tabPosition:"left"}},components:{vUserconfig:i.default,vDepartment:r.default}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"trace"},[t("div",{staticClass:"btn_box"}),this._v(" "),t("el-row",{attrs:{gutter:24}},[t("el-col",{staticClass:"leftMod",attrs:{span:6}},[t("v-department")],1),this._v(" "),t("el-col",{attrs:{span:16}},[t("v-userconfig")],1)],1)],1)},staticRenderFns:[]};var a=s("VU/8")(n,l,!1,function(e){s("bw9u")},"data-v-28676fd0",null);t.default=a.exports}});