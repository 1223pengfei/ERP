webpackJsonp([6],{HJYl:function(e,t){},XBjC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),o=a.n(r),s=a("exGp"),i=a.n(s),l=a("bOdI"),n=a.n(l),p={props:{userItem:Array,oemListadd:Array,productList:Array,nailList:Array,without:String},data:function(){var e;return e={formrules:{prov:[{required:!0,message:"请选择产品编码",trigger:"change"}],fuserid:[{required:!0,message:"请选择负责人",trigger:"change"}],que:[{required:!0,message:"请选择问题点",trigger:"change"}],value:[{required:!0,message:"请选择主机厂",trigger:"change"}]},tablewithout:"暂无数据",dialogFormVisible:!1,expands:[],disabled:!0,visible:!1,editProduct:!1,editVisible:!1,materialurl:"",procode:"",inputValue:"",valueLine:"",typevalue:"",date1:"",materialid:[],form:{fuserid:"",name:"",cause:"",solution:"",que:"",question:"",quetype:"",value:"",remark:""}},n()(e,"dialogFormVisible",!1),n()(e,"formLabelWidth","120px"),n()(e,"input",""),n()(e,"fileName",""),n()(e,"uploadUrl",""),n()(e,"radioImg",1),n()(e,"radiofile",2),n()(e,"fileList",[]),n()(e,"imgList",[]),n()(e,"alarmList",[]),n()(e,"allproductList",[]),n()(e,"departmentOptions",[]),n()(e,"cascaderData",[]),n()(e,"selectedOptions",[]),n()(e,"lotnumber",""),n()(e,"serialnum",""),n()(e,"serialid",""),n()(e,"oemid",""),n()(e,"prov",""),n()(e,"city",""),n()(e,"district",""),n()(e,"queP",[]),n()(e,"quePlist",""),n()(e,"productID",""),n()(e,"imgID",""),n()(e,"fileID",""),n()(e,"cityArr",[]),n()(e,"userList",[]),n()(e,"districtArr",[]),n()(e,"fileidList",[]),n()(e,"fileLIst",[]),n()(e,"fileLIstID",""),n()(e,"relatedList",[]),e},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.fileLIst=t.materialid.concat(t.fileidList),t.fileLIstID=t.fileLIst.join("_"),t.editProduct=!1;var a=new URLSearchParams;a.append("MIDs",t.fileLIstID),a.append("serailid",t.productID),a.append("fuserid",t.form.fuserid),a.append("cause",t.form.cause),a.append("solution",t.form.solution),a.append("NIDs",t.form.que),a.append("remark",t.form.remark),a.append("oemid",t.form.value),t.$http.post("/alarm/Set.do",a).then(function(e){console.log(e),"permission.html"===e.data?t.$message.error("您没有权限！请联系管理员！"):(""!=e&&t.$message.success("添加成功"),t.$refs.form.resetFields(),t.$refs.uploadImg.clearFiles(),t.$refs.upload.clearFiles(),t.fileID="")})})},onSubmitProduct:function(){var e=this;if(""!=this.form.prov&&""!=this.form.name){var t=new URLSearchParams;t.append("productid",this.form.prov),t.append("procode",this.procode),t.append("serialnumber",this.form.name),this.$http.post("/product/SetOne.do",t).then(function(t){"permission.html"===t.data?e.$message.error("您没有权限！请联系管理员！"):(e.productID=t.data,""!=e.productID&&(e.disabled=!1),e.$message.success("添加成功！"))})}else this.$message.error("请选择产品编码，输入产品序列号！")},updateCity:function(){for(var e in this.allproductList){var t=this.allproductList[e];if(t.proname==this.prov){this.cityArr=t.remarks;break}}},uploadImg:function(e){this.formDataImg.append("uploadFile",e.file),this.formDataImg.append("type",this.radioImg)},handleSubmit:function(){var e=this;return i()(o.a.mark(function t(){var a,r,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.formDataImg=new FormData,e.$refs.uploadImg.submit(),a={headers:{"Content-Type":"multipart/form-data"}},t.next=5,e.$http.post("/materail/uploads",e.formDataImg,a);case 5:r=t.sent,"permission.html"===(s=r.data).data?e.$message.error("您没有权限！请联系管理员！"):""!=s&&(e.$message.success("上传成功！"),e.materialid=s);case 8:case"end":return t.stop()}},t,e)}))()},uploadFile:function(e){this.formData.append("uploadFile",e.file),this.formData.append("type",this.radiofile)},handleSubmitfile:function(){var e=this;return i()(o.a.mark(function t(){var a,r,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.formData=new FormData,e.$refs.upload.submit(),a={headers:{"Content-Type":"multipart/form-data"}},t.next=5,e.$http.post("/materail/uploads",e.formData,a);case 5:r=t.sent,"permission.html"===(s=r.data).data?e.$message.error("您没有权限！请联系管理员！"):""!=s&&(e.$message.success("上传成功！"),e.fileidList=s);case 8:case"end":return t.stop()}},t,e)}))()},handleChange:function(e,t){},handleChangeimg:function(e,t){},beforeUpload:function(e){e.size/1024/1024<100||this.$message.error("上传的文件大小不能超过100M哦！")},getAllRelated:function(){var e=this;this.$http.post("/nail/List.do").then(function(t){"permission.html"===t.data?e.tablewithout="无权限，请联系管理员":e.relatedList=t.data})}},beforeMount:function(){this.updateCity()},watch:{prov:function(){for(var e=0;e<this.allproductList.length;e++)this.prov==this.allproductList[e].productid&&(this.procode=this.allproductList[e].procode);this.updateCity()}},created:function(){this.getAllRelated()}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-box clearfix"},[a("div",{staticClass:"main"},[a("el-form",{ref:"form",staticClass:"formItem",attrs:{model:e.form,rules:e.formrules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"选择产品",prop:"prov"}},[a("el-select",{staticClass:"div1",attrs:{filterable:"",placeholder:"选择产品编码"},model:{value:e.form.prov,callback:function(t){e.$set(e.form,"prov",t)},expression:"form.prov"}},[a("template",{slot:"empty"},[a("p",[e._v(e._s(e.without))])]),e._v(" "),e._l(e.productList,function(e){return a("el-option",{key:e.productid,attrs:{value:e.productid,label:e.proname}})})],2)],1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{"label-width":"0",prop:"name"}},[a("el-input",{attrs:{placeholder:"选择输入产品序列号"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name "}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"product-btn",attrs:{"label-width":"0"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.onSubmitProduct()}}},[e._v("添加")])],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"30%"},attrs:{label:"添加图片"}},[a("el-form",{ref:"form"},[a("el-upload",{ref:"uploadImg",staticClass:"upload-demo",attrs:{accept:".jpg, .png, .gif, .jpeg","file-list":e.imgList,"on-change":e.handleChangeimg,action:e.uploadUrl,"http-request":e.uploadImg,"show-file-list":!0,"before-upload":e.beforeUpload,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",type:"primary",size:"small"},slot:"trigger"},[e._v("选取图片")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"30%"},attrs:{label:"添加文件"}},[a("el-form",{ref:"form1"},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{accept:".pdf, .doc, .docx, .txt, .ppt, .xls, .xlsx","file-list":e.fileList,"on-change":e.handleChange,action:e.uploadUrl,"http-request":e.uploadFile,"show-file-list":!0,"before-upload":e.beforeUpload,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",type:"primary",size:"small"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.handleSubmitfile}},[e._v("提交")])],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"原因分析",prop:"cause"}},[a("el-input",{attrs:{type:"textarea",placeholder:"100字以内",rows:"5"},model:{value:e.form.cause,callback:function(t){e.$set(e.form,"cause",t)},expression:"form.cause"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"解决方案",prop:"solution"}},[a("el-input",{attrs:{type:"textarea",placeholder:"100字以内",rows:"5"},model:{value:e.form.solution,callback:function(t){e.$set(e.form,"solution",t)},expression:"form.solution"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人",prop:"fuserid"}},[a("el-select",{attrs:{filterable:"",placeholder:"可搜索"},model:{value:e.form.fuserid,callback:function(t){e.$set(e.form,"fuserid",t)},expression:"form.fuserid"}},[a("template",{slot:"empty"},[a("p",[e._v(e._s(e.without))])]),e._v(" "),e._l(e.userItem,function(e){return a("el-option",{key:e.personid,attrs:{label:e.personname,value:e.personid}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"问题点",prop:"que"}},[a("el-select",{staticClass:"div1",attrs:{filterable:"",placeholder:"选择问题点"},model:{value:e.form.que,callback:function(t){e.$set(e.form,"que",t)},expression:"form.que"}},[a("template",{slot:"empty"},[a("p",[e._v(e._s(this.without))])]),e._v(" "),e._l(e.nailList,function(e){return a("el-option",{key:e.nailid,attrs:{value:e.nailid,label:e.nailname}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"主机厂",prop:"value"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}},[a("template",{slot:"empty"},[a("p",[e._v(e._s(e.without))])]),e._v(" "),e._l(e.oemListadd,function(e){return a("el-option",{key:e.oemid,attrs:{label:e.oemname,value:e.oemid}})})],2)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"备注",prop:"remark"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"footer-btn"},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){e.onSubmit("form")}}},[e._v("提交")])],1)])],1)])},staticRenderFns:[]};var m=a("VU/8")(p,u,!1,function(e){a("HJYl")},"data-v-47611b1e",null);t.default=m.exports}});